!function(){var t=function(n,r,o){classd=n.replace(new RegExp(" "),"."),function(n,r,o,s){var i,l,c=function(t){var e,a,n;t.length>1?(e=moment(_.min(t)),a=moment(_.max(t)),n=function(t,e){return e.diff(t,"years")>0?"months":e.diff(t,"months")>0?"days":e.diff(t,"days")>0?"days":e.diff(t,"hours")>0?"hours":e.diff(t,"minutes")>0?"minutes":"seconds"}(e,a),e.subtract(1,n),a.add(1,n)):(e=moment(t[0]).subtract(1,"hour"),a=moment(t[0]).add(1,"hour"));return{minDate:e,maxDate:a,pad:n}}(_.pluck(o,"value")),d={top:10,right:25,bottom:15,left:35},u=window.innerWidth-150,m=e(c.pad)?100-d.top-d.bottom:300-d.top-d.bottom,f=d3.time.scale().range([0+d.right,u-d.left]),p=d3.time.scale().range([d.top,m-d.bottom-d.top]),h=u>800?8:4;if(f.domain(d3.extent([c.minDate,c.maxDate])),e(c.pad))i="%H:%M",l="%m/%d/%y",p.domain(d3.extent([c.minDate]));else{i="%m/%d/%y",l="%H:%M";var b=new Date(2012,0,1,0,0,0,0).getTime(),g=new Date(2012,0,1,23,59,59,59).getTime();p.domain(d3.extent([b,g]))}var v=d3.svg.axis().scale(f).orient("bottom").ticks(h).tickSize(-m,0).tickFormat(d3.time.format(i)),x=d3.svg.axis().scale(p).orient("left").ticks(5).tickSize(-u+d.right,d.left).tickFormat(d3.time.format(l)),y=d3.select("."+n).append("svg").attr("width",u+d.left+d.right).attr("height",m+d.top+d.bottom).append("g").attr("class","context").attr("transform","translate("+d.left+","+d.top+")");y.append("g").attr("class","x axis").attr("transform","translate("+d.left+","+(d.top+(m-d.bottom))+")").call(v),y.append("g").attr("class","y axis").attr("transform","translate("+d.left+","+d.top+")").call(x);var k=y.append("g").attr("transform","translate("+d.left+","+d.top+")");if(k.selectAll(".circ").data(o).enter().append("circle").attr("class","circ").attr("cx",function(t){return e(c.pad)?f(t.value):f(a(t.value))}).attr("cy",function(t,n){return e(c.pad)?p(a(t.value)):p(function(t){var e=moment(t);return e.date(1),e.month(0),e.year(2012),e.valueOf()}(t.value))}).attr("r",9).on("click",function(t){console.log(new Date(t.value))}),s){var w=d3.svg.brush().x(f).on("brush",_.throttle(function(){w.empty()||(d3.select(".clear-brush").style("display","inline-block"),d3.select(".brush-info")[0][0].innerText=w.extent())},200));k.append("g").attr("class","brush").call(w).selectAll("rect").attr("y",-6).attr("height",m-d.bottom);window.document.getElementsByClassName(r)[0].insertAdjacentHTML("beforeend",'<div class="brush-control"><div class="brush-info"><i>Click and drag on the timeseries to create a brush.</i></div><button class="clear-brush">Clear brush</button></div>'),d3.select(".clear-brush").on("click",function(t){w.empty()||(d3.selectAll("g.brush").call(w.clear()),d3.select(".brush-info")[0][0].innerText="",d3.select(".clear-brush").style("display","none"))}),t.getBrushExtent=function(){if(w)return w.extent()}}}(classd,n,r,o)};function e(t){return"hours"===t||"minutes"===t||"seconds"===t}function a(t){var e=moment(t);return e.hour(1),e.minute(0),e.second(0),e.valueOf()}"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports&&(module.exports=t),this.timeseries=t}();